name: Build (Debian aarch64)
on:
  push:
    branches: [ next ]
jobs:
  build-debian-aarch64:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: uraimo/run-on-arch-action@v2
      name: Builds Cork
      id: build
      with:
        arch: aarch64
        distro: bullseye

        run: |
          apt-get update && apt-get install -yq git build-essential cmake libboost-all-dev libzip-dev libssl-dev libcurl4-openssl-dev zlib1g-dev libbz2-dev liblzma-dev
          mkdir build
          cmake -Bbuild -H. -DBUILD_SHARED_LIBS=0
          cmake --build build/ --target all
    - name: Upload binary
      uses: actions/upload-artifact@v1
      with:
        name: binary
        path: build/src/cork